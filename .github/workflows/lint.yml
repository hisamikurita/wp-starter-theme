name: Lint

on:
  push:
    branches: [master, main]

jobs:
  lint:
    runs-on: ubuntu-latest
    steps:
      #å…¬å¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã€Œactions/checkoutã€å®Ÿè¡Œã™ã‚‹ã€‚ãƒªãƒã‚¸ãƒˆãƒªã‚’ã‚¯ãƒ­ãƒ¼ãƒ³ã—ã¦ãã‚‹
      - name: ğŸ“¦ Get latest code
        uses: actions/checkout@v3

      #nodeã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’æŒ‡å®š
      - name: ğŸ’» Setup node
        uses: actions/setup-node@v3 #å…¬å¼ã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã‚’ä½¿ç”¨ã™ã‚‹
        with: #å¼•æ•°ã§ãƒãƒ¼ã‚¸ãƒ§ãƒ³æŒ‡å®š
          node-version: "18"

      #ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
      - name: âš¡ Cache node modules
        uses: actions/cache@v3
        with:
          path: node_modules
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }}
          restore-keys: |
            ${{ runner.os }}-node-

      #node moduleã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
      - name: ğŸ˜‰ Install modules
        run: npm install && npm rebuild --arch=x64 --platform=linux sharp
        working-directory: ./ #ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ãƒˆãƒƒãƒ—ã§å®Ÿè¡Œ

      #Lintã‚’å®Ÿè¡Œ
      - name: ğŸ¶ Lint Project
        run: npm run format && npm run lint:fix
